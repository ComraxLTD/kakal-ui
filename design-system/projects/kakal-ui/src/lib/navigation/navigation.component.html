<div fxFill fxLayout="column" dir="rtl">
  <ng-container *ngIf="stepMap$ | async as stepMap">
    <nav fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="1.5rem">
      <ng-container *ngIf="activeStep$ | async as activeStep">
        <!-- previous button -->
        <div
          fxLayout="row"
          fxLayoutAlign="space-between center"
          fxFill
          fxLayoutGap="1.5rem"
          fxFlex
        >
          <button
            mat-icon-button
            (click)="onPrev(activeStep.value, stepMap[activeStep.value - 1])"
            [disabled]="activeStep.value === 0"
          >
            <kkl-icon
              [disabled]="activeStep.value === 0"
              key="arrow_forward_ios"
              color="primary"
            ></kkl-icon>
          </button>

          <!-- show current step label -->

          <ng-template
            *ngTemplateOutlet="
              slots?.content;
              context: { $implicit: stepMap[activeStep.value] }
            "
          ></ng-template>

          <!-- forward button -->
          <button
            mat-icon-button
            (click)="onNext(activeStep.value, stepMap[activeStep.value + 1])"
            [disabled]="end$ | async"
          >
            <kkl-icon
              [disabled]="end$ | async"
              key="arrow_back_ios"
              color="primary"
            ></kkl-icon>
          </button>
        </div>

        <!-- steps items -->
        <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="2rem">
          <ng-container
            *ngFor="let item of stepMap | keyvalue; let index = index"
          >
            <ng-template
              *ngTemplateOutlet="slots?.step; context: { $implicit: this.item }"
            ></ng-template>
          </ng-container>
        </div>
      </ng-container>
    </nav>
  </ng-container>
  <main></main>
</div>
