<ng-container [ngSwitch]="variant" (window:resize)="onResize($event)">
  <ng-container *ngSwitchCase="'grid'">
    <form (ngSubmit)="onSubmitEvent()" [formGroup]="formGroup" autocomplete="off">
      <mat-grid-list [cols]="breakpoint" [rowHeight]="(rowHeight || 9) + 'rem'" [gutterSize]="(gutter) + 'rem'">

        <ng-container *ngFor="let question of myQuestions; let index = index">
          <mat-grid-tile [colspan]=" question?.cols > breakpoint? breakpoint : question?.cols || 1" [rowspan]="question?.rows || 1">
            <div [ngSwitch]="question.controlType" fxFlex="100">



              <ng-container *ngSwitchCase="'select'">
                <kkl-select
                  [control]="formGroup.controls[question.key]"
                  [options]="question.options"
                  [multi]="question.multi"
                  [placeHolder]="question.placeHolder"
                  [key]="question.key"
                  [label]="question.label"
                  [theme]="question.theme"
                  [appearance]="question.appearance"
                  [disabled]="question.disabled"
                  (selectChanged)="onSelectChanged($event, question)"
                  (openedChange)="onOpenedChange($event, question)"
                ></kkl-select>
              </ng-container>
              <ng-container *ngSwitchCase="'autocomplete'">
                <ng-container *ngIf="question.multi; else simpleAutocomplete">
                  <kkl-multi-autocomplete
                    [control]="formGroup.controls[question.key]"
                    [options]="question.options"
                    [placeHolder]="question.placeHolder"
                    [key]="question.key"
                    [label]="question.label"
                    [debounce]="question.debounce"
                    [appearance]="question.appearance"
                    [disabled]="question.disabled"
                    [withButton]="question.withButton"
                    [icon]="question.icon"
                    [panelWidth]="question.panelWidth"
                    (queryChanged)="onQueryChanged($event, question)"
                    (selectChanged)="onSelectChanged($event, question)"
                    (openedChange)="onOpenedChange($event, question)">
                  </kkl-multi-autocomplete>
                </ng-container>
                <ng-template #simpleAutocomplete>
                  <kkl-autocomplete
                    [control]="formGroup.controls[question.key]"
                    [options]="question.options"
                    [placeHolder]="question.placeHolder"
                    [key]="question.key"
                    [label]="question.label"
                    [debounce]="question.debounce"
                    [appearance]="question.appearance"
                    [disabled]="question.disabled"
                    [withButton]="question.withButton"
                    [icon]="question.icon"
                    [panelWidth]="question.panelWidth"
                    (queryChanged)="onQueryChanged($event, question)"
                    (selectChanged)="onSelectChanged($event, question)"
                    (openedChange)="onOpenedChange($event, question)"
                  ></kkl-autocomplete>
                </ng-template>
              </ng-container>
              <ng-container *ngSwitchCase="'date'">
                <kkl-datepicker
                  [label]="question.label"
                  [control]="formGroup.controls[question.key]"
                  [key]="question.key"
                  [placeHolder]="question.placeHolder"
                  [maxDate]="question.maxDate"
                  [minDate]="question.minDate"
                  [appearance]="question.appearance"
                  (focusChanged)="onFocusChanged($event, question)"
                  (valueChanged)="onValueChanged($event, question)"
                >
                </kkl-datepicker>
              </ng-container>
              <ng-container *ngSwitchCase="'dateRange'">
                <kkl-range-datepicker
                  [groupControl]="formGroup.controls[question.key]"
                  [key]="question?.key"
                  [label]="question?.label"
                  [maxDate]="question.maxDate"
                  [minDate]="question.minDate"
                  [appearance]="question?.appearance"
                  (focusChanged)="onFocusChanged($event, question)"
                  (valueChanged)="onValueChanged($event, question)"
                >
                </kkl-range-datepicker>
              </ng-container>
              <ng-container *ngSwitchCase="'radio'">
                <kkl-radio-group
                  [control]="formGroup.controls[question.key]"
                  [label]="question.label"
                  [key]="question.key"
                  [placeHolder]="question.placeHolder"
                  [options]="question.options"
                  (selectChanged)="onSelectChanged($event, question)"
                ></kkl-radio-group>
              </ng-container>
              <ng-container *ngSwitchCase="'toggle'">
                <kkl-slide-toggle
                  [control]="formGroup.controls[question.key]"
                  [label]="question.label"
                  [key]="question.key"
                  (selectChanged)="onSelectChanged($event, question)"
                ></kkl-slide-toggle>
              </ng-container>
              <ng-container *ngSwitchCase="'checkbox'">
                <kkl-checkbox
                  [control]="formGroup.controls[question.key]"
                  [label]="question.label"
                  [key]="question.key"
                  (selectChanged)="onSelectChanged($event, question)"
                ></kkl-checkbox>
              </ng-container>
              <ng-container *ngSwitchCase="'currency'">
                <kkl-currency
                  [groupControl]="formGroup.controls[question.key]"
                  [label]="question.label"
                  [key]="question.key"
                  [placeHolder]="question.placeHolder"
                  [theme]="question.theme"
                  [appearance]="question.appearance"
                  [debounce]="question.debounce"
                  (focusChanged)="onFocusChanged($event, question)"
                  (valueChanged)="onValueChanged($event, question)"
                >
                </kkl-currency>
              </ng-container>
              <ng-container *ngSwitchCase="'texteditor'">
                <kkl-text-editor
                  [key]="question?.key"
                  [control]="formGroup.controls[question.key]"
                  [placeHolder]="question.placeHolder"
                  [debounce]="question.debounce"
                  (valueChanged)="onValueChanged($event, question)"
                ></kkl-text-editor>
              </ng-container>
              <ng-container *ngSwitchCase="'range'">
                <kkl-range
                  [groupControl]="formGroup.controls[question.key]"
                  [label]="question.label"
                  [key]="question.key"
                  [theme]="question.theme"
                  [appearance]="question.appearance"
                  [debounce]="question.debounce"
                  (focusChanged)="onFocusChanged($event, question)"
                  (valueChanged)="onValueChanged($event, question)"
                ></kkl-range>
              </ng-container>
              <ng-container *ngSwitchCase="'costum'">
                <ng-container *ngTemplateOutlet="templates[question.key]"></ng-container>
              </ng-container>
              <ng-container *ngSwitchCase="'counter'">
                <!-- <div fxFill [fxLayoutAlign]="question?.gridProps?.flex?.align || 'center' + ' center'">
                  <div [fxFlex]="question?.gridProps?.flex?.width || 100"> -->
                    <kkl-counter
                      [control]="formGroup.controls[question.key]"
                      [label]="question.label"
                      [key]="question.key"
                      [placeHolder]="question.placeHolder"
                      [icon]="question.icon"
                      [debounce]="question.debounce"
                      (focusChanged)="onFocusChanged($event, question)"
                      (valueChanged)="onValueChanged($event, question)"
                    >
                    </kkl-counter>
                  <!-- </div>
                </div> -->
              </ng-container>
              <ng-container *ngSwitchDefault>
                <!-- <div fxFill [fxLayoutAlign]="question?.gridProps?.flex?.align || 'center' + ' center'">
                  <div [fxFlex]="question?.gridProps?.flex?.width || 100"> -->
                    <kkl-input
                      [control]="formGroup.controls[question.key]"
                      [label]="question.label"
                      [key]="question.key"
                      [placeHolder]="question.placeHolder"
                      [theme]="question.theme"
                      [appearance]="question.appearance"
                      [icon]="question.icon"
                      [format]="question.format"
                      [controlType]="question?.controlType"
                      [debounce]="question.debounce"
                      (focusChanged)="onFocusChanged($event, question)"
                      (valueChanged)="onValueChanged($event, question)"
                    >
                    </kkl-input>
                  <!-- </div>
                </div> -->
              </ng-container>

            </div>
          </mat-grid-tile>
        </ng-container>

        <mat-grid-tile *ngIf="grid?.buttonCols" [colspan]="grid?.buttonCols || 1">
          <div class="btn-form" fxFlex="100">
            <button type="submit" kkl-border color="primary" [thick]="2" mat-stroked-button color="primary" [disabled]="!formGroup.valid">{{ buttonLabel }}</button>
          </div>
        </mat-grid-tile>
      </mat-grid-list>
    </form>

  </ng-container>


  <ng-container *ngSwitchCase="'flex'">
    <form (ngSubmit)="onSubmitEvent()" [formGroup]="formGroup" [fxLayout]="layout + ' wrap'" [fxLayoutGap]="offset+'px'" fxLayoutAlign="start center" autocomplete="off">
      <ng-container *ngFor="let question of myQuestions; let index = index">
        <ng-container [ngSwitch]="question.controlType">
          <div [fxFlex]="question.cols*flex" style="min-width: 500px !important;">
          <!-- SELECT INPUT SECTION -->
            <ng-container *ngSwitchCase="'select'">
                <kkl-select
                  [control]="formGroup.controls[question.key]"
                  [options]="question.options"
                  [multi]="question.multi"
                  [placeHolder]="question.placeHolder"
                  [key]="question.key"
                  [label]="question.label"
                  [theme]="question.theme"
                  [appearance]="question.appearance"
                  [disabled]="question.disabled"
                  (selectChanged)="onSelectChanged($event, question)"
                  (openedChange)="onOpenedChange($event, question)"
                ></kkl-select>
            </ng-container>
            <ng-container *ngSwitchCase="'autocomplete'">
              <ng-container *ngIf="question.multi; else simpleAutocomplete">
                <kkl-multi-autocomplete
                  [control]="formGroup.controls[question.key]"
                  [options]="question.options"
                  [placeHolder]="question.placeHolder"
                  [key]="question.key"
                  [label]="question.label"
                  [debounce]="question.debounce"
                  [appearance]="question.appearance"
                  [disabled]="question.disabled"
                  [withButton]="question.withButton"
                  [icon]="question.icon"
                  [panelWidth]="question.panelWidth"
                  (queryChanged)="onQueryChanged($event, question)"
                  (selectChanged)="onSelectChanged($event, question)"
                  (openedChange)="onOpenedChange($event, question)">
                </kkl-multi-autocomplete>
              </ng-container>
              <ng-template #simpleAutocomplete>
                <kkl-autocomplete
                  [control]="formGroup.controls[question.key]"
                  [options]="question.options"
                  [placeHolder]="question.placeHolder"
                  [key]="question.key"
                  [label]="question.label"
                  [debounce]="question.debounce"
                  [appearance]="question.appearance"
                  [disabled]="question.disabled"
                  [withButton]="question.withButton"
                  [icon]="question.icon"
                  [panelWidth]="question.panelWidth"
                  (queryChanged)="onQueryChanged($event, question)"
                  (selectChanged)="onSelectChanged($event, question)"
                  (openedChange)="onOpenedChange($event, question)"
                ></kkl-autocomplete>
              </ng-template>
            </ng-container>
            <ng-container *ngSwitchCase="'date'">
              <kkl-datepicker
                [control]="formGroup.controls[question.key]"
                [key]="question.key"
                [label]="question.label"
                [placeHolder]="question.placeHolder"
                [maxDate]="question.maxDate"
                [minDate]="question.minDate"
                [appearance]="question.appearance"
                (focusChanged)="onFocusChanged($event, question)"
                (valueChanged)="onValueChanged($event, question)"
              ></kkl-datepicker>
            </ng-container>
            <ng-container *ngSwitchCase="'dateRange'">
              <kkl-range-datepicker
                [groupControl]="formGroup.controls[question.key]"
                [key]="question?.key"
                [label]="question?.label"
                [appearance]="question?.appearance"
                [maxDate]="question.maxDate"
                [minDate]="question.minDate"
                (focusChanged)="onFocusChanged($event, question)"
                (valueChanged)="onValueChanged($event, question)"
              ></kkl-range-datepicker>
            </ng-container>
            <ng-container *ngSwitchCase="'radio'">
              <kkl-radio-group
                [control]="formGroup.controls[question.key]"
                [label]="question.label"
                [key]="question.key"
                [placeHolder]="question.placeHolder"
                [options]="question.options"
                (selectChanged)="onSelectChanged($event, question)"
              ></kkl-radio-group>
            </ng-container>
            <ng-container *ngSwitchCase="'toggle'">
              <kkl-slide-toggle
                [control]="formGroup.controls[question.key]"
                [label]="question.label"
                [key]="question.key"
                (selectChanged)="onSelectChanged($event, question)"
              ></kkl-slide-toggle>
            </ng-container>
            <ng-container *ngSwitchCase="'checkbox'">
              <kkl-checkbox
                [control]="formGroup.controls[question.key]"
                [label]="question.label"
                [key]="question.key"
                (selectChanged)="onSelectChanged($event, question)"
              ></kkl-checkbox>
            </ng-container>
            <ng-container *ngSwitchCase="'currency'">
              <kkl-currency
                [groupControl]="formGroup.controls[question.key]"
                [label]="question.label"
                [key]="question.key"
                [placeHolder]="question.placeHolder"
                [theme]="question.theme"
                [appearance]="question.appearance"
                [debounce]="question.debounce"
                (focusChanged)="onFocusChanged($event, question)"
                (valueChanged)="onValueChanged($event, question)"
                (selectChanged)="onSelectChanged($event, question)"
              >
              </kkl-currency>
            </ng-container>
            <ng-container *ngSwitchCase="'texteditor'">
              <div fxLayout="column">
                <div [fxFlex]="((question?.rows * 10) || 40) + 'rem'">
                  <kkl-text-editor
                    [key]="question?.key"
                    [control]="formGroup.controls[question.key]"
                    [placeHolder]="question.placeHolder"
                    [debounce]="question.debounce"
                    (valueChanged)="onValueChanged($event, question)"
                  ></kkl-text-editor>
                </div>
              </div>
            </ng-container>
            <ng-container *ngSwitchCase="'range'">
              <kkl-range
                [groupControl]="formGroup.controls[question.key]"
                [label]="question.label"
                [key]="question.key"
                [theme]="question.theme"
                [appearance]="question.appearance"
                [debounce]="question.debounce"
                (focusChanged)="onFocusChanged($event, question)"
                (valueChanged)="onValueChanged($event, question)"
              ></kkl-range>
            </ng-container>
            <ng-container *ngSwitchCase="'costum'">
              <ng-container *ngTemplateOutlet="templates[question.key]"></ng-container>
            </ng-container>
            <ng-container *ngSwitchCase="'counter'">
              <kkl-counter
                [control]="formGroup.controls[question.key]"
                [label]="question.label"
                [key]="question.key"
                [placeHolder]="question.placeHolder"
                [icon]="question.icon"
                [debounce]="question.debounce"
                (focusChanged)="onFocusChanged($event, question)"
                (valueChanged)="onValueChanged($event, question)"
              >
              </kkl-counter>
            </ng-container>
            <ng-container *ngSwitchDefault>
              <kkl-input
                [control]="formGroup.controls[question.key]"
                [label]="question.label"
                [key]="question.key"
                [placeHolder]="question.placeHolder"
                [theme]="question.theme"
                [appearance]="question.appearance"
                [icon]="question.icon"
                [format]="question.format"
                [controlType]="question.controlType"
                [debounce]="question.debounce"
                (focusChanged)="onFocusChanged($event, question)"
                (valueChanged)="onValueChanged($event, question)"
              ></kkl-input>
            </ng-container>

          </div>

        </ng-container>
      </ng-container>

      <ng-container *ngIf="grid?.buttonCols">
        <div [class.button-container]="true" fxFlex kkl-form-button>
          <kkl-stroke-button type="submit" color="primary" [disabled]="!formGroup.valid">{{ buttonLabel }}</kkl-stroke-button>
        </div>
      </ng-container>

    </form>

  </ng-container>
</ng-container>

