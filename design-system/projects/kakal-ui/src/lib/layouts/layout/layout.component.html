<ng-container *ngIf="portion$ | async as portion">
  <mat-sidenav-container class="kkl-sidenav-container" dir="rtl">
    <mat-sidenav #menuDrawer class="menu" mode="push" position="start">
      <ng-container>
        <div
          class="menu-container"
          fxLayout="column"
          fxLayoutAlign=" space-around center"
        >
          <div
            fxFill
            fxLayout="column"
            fxLayoutAlign="center center"
            fxFlex="8rem"
            fxLayoutGap="0.5rem"
            kkl-underline
            kkl-button
            (click)="onStartSideNav('menu')"
          >
            <kkl-icon
              color="primary"
              kkl-button
              [key]="'tree_gradient_' + rootPrefix || 'lands'"
              [size]="4"
            ></kkl-icon>
            <div fxFlex="10" fxLayoutAlign="start center">
              <kkl-typography [size]="1" color="primary">
                סגור תפריט
              </kkl-typography>
            </div>
          </div>
          <kkl-menu-bar
            [cards]="cards"
            (menuSelected)="onMenuSelected($event)"
            [templates]="menuTemplates"
          ></kkl-menu-bar>
        </div>
      </ng-container>
    </mat-sidenav>

    <mat-sidenav
      *ngIf="showEndDrawer"
      #endDrawer
      class="sidenav-drawer"
      [opened]="true"
      fxLayoutAlign="stretch stretch"
      mode="side"
      position="end"
      [ngStyle]="{ width: (endDrawerSize$ | async) + '%' }"
    >
      <!-- end drawer content -->
      <div fxLayout="row" fxFill fxLayoutAlign="stretch stretch">
        <div fxFlex="100" fxLayout="column" fxFill>
          <div
            class="end-drawer-button"
            (click)="emitEndDrawer()"
            *ngIf="portion != 1 && portion != 99"
          >
            <!-- end drawer button -->
            <kkl-icon
              [key]="'chevron_left'"
              color="success"
              [size]="4"
            ></kkl-icon>
          </div>
          <ng-content select="[endDrawerContent]"></ng-content>
        </div>
      </div>
    </mat-sidenav>

    <mat-sidenav-content [fxFlex]="portion">
      <kkl-navbar
        [status]="status"
        [showStatus$]="showStatus$"
        [isOpen]="menuDrawer.opened"
        (menuToggle)="onStartSideNav('menu')"
        (logoClicked)="onLogoClicked()"
        (statusSelection)="onStatusSelection($event)"
      ></kkl-navbar>

      <kkl-icon
        *ngIf="portion === 1 || portion === 99"
        [size]="10"
        [key]="'drawer_toggle_icon'"
        (click)="emitEndDrawer()"
        class="end-drawer-btn"
      ></kkl-icon>

      <ng-content content></ng-content>

      <ng-container *ngIf="!(hideFooter$ | async)">
        <div class="navbar-bottom">
          <kkl-navbar-bottom></kkl-navbar-bottom>
        </div>
      </ng-container>
    </mat-sidenav-content>
  </mat-sidenav-container>
</ng-container>
