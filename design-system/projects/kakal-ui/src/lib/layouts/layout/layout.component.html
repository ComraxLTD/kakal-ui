<ng-container *ngIf="portion$ | async as portion">
  <mat-sidenav-container class="kkl-sidenav-container" dir="rtl">
    <mat-sidenav #menuDrawer class="menu" mode="push" position="start">
      <ng-container>
        <div
          class="menu-container"
          fxLayout="column"
          fxLayoutAlign=" space-around center"
        >
          <div
            fxFill
            fxLayout="column"
            fxLayoutAlign="center center"
            fxFlex="8rem"
            fxLayoutGap="0.5rem"
            kkl-underline
            kkl-button
            (click)="onStartSideNav('menu')"
          >
            <kkl-icon
              color="primary"
              kkl-button
              [key]="'tree_gradient_' + rootPrefix || 'lands'"
              [size]="4"
            ></kkl-icon>
            <div fxFlex="10" fxLayoutAlign="start center">
              <kkl-typography [size]="1" color="primary">
                סגור תפריט
              </kkl-typography>
            </div>
          </div>
          <kkl-menu-bar
            [cards]="cards"
            (menuSelected)="onMenuSelected($event)"
            [templates]="menuTemplates"
          ></kkl-menu-bar>
        </div>
      </ng-container>
    </mat-sidenav>

    <mat-sidenav
      #endDrawer
      class="sidenav-drawer"
      [opened]="portion.show"
      fxLayoutAlign="stretch stretch"
      mode="side"
      position="end"
      [ngStyle]="{ width: portion.drawer + '%' }"
    >
      <!-- end drawer content -->
      <div fxLayout="row" fxFill fxLayoutAlign="stretch stretch">
        <div fxFlex fxLayout="column" fxLayoutAlign="center center">
          <ng-container *ngIf="portion.hasButton">
            <div class="end-drawer-button" (click)="emitEndDrawer()">
              <!-- end drawer button -->
              <kkl-icon
                [key]="'chevron_left'"
                color="success"
                [size]="4"
              ></kkl-icon>
            </div>
          </ng-container>
        </div>
        <div fxFlex>
          <ng-content select="[endDrawerContent]"></ng-content>
        </div>
      </div>
    </mat-sidenav>

    <mat-sidenav-content [fxFlex]="portion.content">
      <kkl-navbar
        [status]="status"
        [showStatus$]="showStatus$"
        [isOpen]="menuDrawer.opened"
        (menuToggle)="onStartSideNav('menu')"
        (logoClicked)="onLogoClicked()"
        (statusSelection)="onStatusSelection($event)"
      ></kkl-navbar>

      <ng-content select="[content]"></ng-content>

      <!-- MOBILE BUTTON FOR PORTION DRAWER -->
      <ng-container *ngIf="portion.mobile">
        <button mat-fab class="end-drawer-btn" (click)="emitEndDrawer()">
          <mat-icon>edit</mat-icon>
        </button>
      </ng-container>

      <ng-container *ngIf="!(hideFooter$ | async)">
        <div class="navbar-bottom">
          <kkl-navbar-bottom></kkl-navbar-bottom>
        </div>
      </ng-container>
    </mat-sidenav-content>
  </mat-sidenav-container>
</ng-container>
