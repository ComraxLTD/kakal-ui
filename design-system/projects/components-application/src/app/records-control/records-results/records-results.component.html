<div fxLayout="row" fxLayoutAlign="center center" dir="rtl">
  <div fxLayout="column" fxLayoutGap="3rem" fxFlex="90">
    <header fxLayout="row" fxLayoutAlign="center center">
      <kkl-form-autocomplete
        fxFlex="33"
        [label]="'הקלד מס תיק'"
        [control]="control"
        [options]="options"
        [optionTemplate]="optionTemplate"
        (optionSelected)="onOptionSelected($event)"
      ></kkl-form-autocomplete>
    </header>

    <main>
      <kkl-local-table
        [dataSource]="dataSource"
        [columns]="columns"
        [colsTemplate]="{action, status}"
      ></kkl-local-table>
    </main>
  </div>
</div>

<ng-template #action let-data>
  <ng-container *ngIf="data">
    <kkl-stroke-button color="primary" (clickEvent)="onActionSelected(data.path)">
      {{ data.label }}
    </kkl-stroke-button>
  </ng-container>
</ng-template>

<ng-template #status let-data>
  <kkl-status-steps [status]="data"></kkl-status-steps>
</ng-template>

<ng-template #optionTemplate let-option>
  <div fxLayout="row" fxLayoutAlign="start center" dir="rtl" fxLayoutGap="3rem">
    <kkl-typography fxFlex="3rem" color="primary" [disabled]="option.disabled">
      {{ option | pluck: "label" }}
    </kkl-typography>
    <kkl-typography color="primary"> | </kkl-typography>
    <mat-icon *ngIf="option.value['status'] === 'temp'" color="primary"
      >schedule</mat-icon
    >
    <kkl-typography
      [color]="option | pluck: 'value' | pluck: 'status' | statusColor"
    >
      גוש {{ option | pluck: "value" | pluck: "gush" }}
    </kkl-typography>
    <kkl-typography
      [color]="option | pluck: 'value' | pluck: 'status' | statusColor"
    >
      חלקה {{ option | pluck: "value" | pluck: "division" }}
    </kkl-typography>
  </div>
</ng-template>
