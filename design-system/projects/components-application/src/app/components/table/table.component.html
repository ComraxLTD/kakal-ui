<div fxFill dir="rtl">
  <div dir="ltr" fxLayout="row" fxLayoutGap="3rem">
    <code *ngIf="tableState$ | async as tableState">
      <div>tableState :</div>
      <pre>
       {{ tableState.filters | json }}
      </pre>
    </code>
    <mat-divider [vertical]="true"></mat-divider>
    <code *ngIf="fetchState$ | async as fetchState">
      <div>fetchState :</div>
      <pre>
        {{ fetchState | json }}
      </pre>
    </code>
  </div>

  <kkl-table
    kkl-table
    kklPagination
    [data$]="data$"
    [columns$]="columns$"
    [itemKey]="itemKey"
    [pagination]="pagination"
    [hasActions]="true"
  >
    <!-- use kklHeaderCell for render header cell -->
    <ng-container *kklHeaderCell="let context">
      <kkl-header-cell
        [itemKey]="context.key"
        [column]="context.column"
        [columnDef]="context.column.columnDef"
        [headerTemplate]="{actions}"
        (fetchOptions)="onFetchOptions($event)"
      ></kkl-header-cell>
    </ng-container>

    <!-- use kklDataCell for render table cell -->
    <ng-container *kklDataCell="let context">
      <!-- use kkl-data-cell for comrax table cell -->
      <kkl-data-cell
        fxLayout="row"
        fxLayoutAlign="start center"
        [item]="context.item"
        [key]="context.key"
        [column]="context.column"
        [group]="context.group"
        [tableState]="context.tableState"
        [inputTemplate]="{input}"
        [cellTemplate]="{email}"
      ></kkl-data-cell>
    </ng-container>

    <!-- use kkl-actions-cell for default actions -edit, delete and save -->
    <ng-container *kklActionCell="let rowState">
      <kkl-actions-cell
        [hasEdit]="true"
        [hasDelete]="true"
        [rowState]="rowState"
        (edit)="onEditEvent($event)"
        (cancel)="onCancelEvent($event)"
        (submit)="onSubmitEvent($event)"
      ></kkl-actions-cell>
    </ng-container>
  </kkl-table>
</div>

<ng-template #email let-rowState>
  <kkl-typography color="primary" underline="true">
    {{ rowState.item.email }}
  </kkl-typography>
</ng-template>

<ng-template #actions let-rowState>
  <kkl-create-button (clickEvent)="onCreateEvent(rowState)">
    הוסף מכונית
  </kkl-create-button>
</ng-template>

<ng-template #input let-rowState>
  <div fxFill fxLayout="row">
    <kkl-form-cell
      fxFlex="70"
      [group]="rowState.group"
      [columnDef]="rowState.column.columnDef"
    ></kkl-form-cell>
  </div>
</ng-template>
